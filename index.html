<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AGORA Master - Le Jeu RH</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --g-blue: #4285F4; --g-red: #EA4335; --g-yellow: #FBBC05; --g-green: #34A853;
            --gray-bg: #f8f9fa; --text: #202124; --border: #dadce0;
        }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { 
            font-family: 'Roboto', sans-serif; margin: 0; background-color: #fff; color: var(--text);
            line-height: 1.5; display: flex; flex-direction: column; min-height: 100vh;
        }
        header { 
            padding: 15px 20px; border-bottom: 1px solid var(--border); 
            display: flex; justify-content: space-between; align-items: center;
            position: sticky; top: 0; background: #fff; z-index: 1000;
        }
        .logo { font-size: 20px; font-weight: 500; }
        .logo span:nth-child(1) { color: var(--g-blue); } .logo span:nth-child(2) { color: var(--g-red); }
        .logo span:nth-child(3) { color: var(--g-yellow); } .logo span:nth-child(4) { color: var(--g-blue); }
        .logo span:nth-child(5) { color: var(--g-green); } .logo span:nth-child(6) { color: var(--g-red); }
        
        .container { max-width: 600px; margin: 0 auto; padding: 20px; width: 100%; }
        
        /* Dashboard Pix Style */
        .skill-card {
            border: 1px solid var(--border); border-radius: 8px; padding: 20px; margin-bottom: 15px;
            cursor: pointer; transition: all 0.2s; display: flex; align-items: center;
        }
        .skill-card:active { transform: scale(0.98); background-color: var(--gray-bg); }
        .skill-icon { width: 45px; height: 45px; border-radius: 8px; margin-right: 15px; display: flex; align-items: center; justify-content: center; font-size: 20px; color: white; }
        .skill-info { flex-grow: 1; }
        .skill-title { font-weight: 500; font-size: 16px; margin: 0; }
        .skill-progress { height: 6px; background: #eee; border-radius: 3px; margin-top: 8px; overflow: hidden; }
        .progress-bar { height: 100%; width: 0%; transition: width 0.5s; }

        /* Quiz UI */
        .hidden { display: none; }
        .question-box { animation: fadeIn 0.4s; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        .option {
            border: 1px solid var(--border); border-radius: 24px; padding: 15px 20px; margin: 10px 0;
            cursor: pointer; transition: 0.2s; font-size: 15px;
        }
        .option:active { background-color: var(--gray-bg); }
        .correct { background-color: #e6f4ea !important; border-color: var(--g-green) !important; color: #137333; }
        .incorrect { background-color: #fce8e6 !important; border-color: var(--g-red) !important; color: #c5221f; }
        
        .feedback { 
            margin-top: 20px; padding: 15px; border-radius: 8px; background: var(--gray-bg); 
            border-left: 4px solid var(--g-blue); font-size: 14px;
        }
        
        .btn {
            background: var(--g-blue); color: white; border: none; padding: 12px 24px;
            border-radius: 4px; font-weight: 500; width: 100%; margin-top: 15px; cursor: pointer;
        }

        .success-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255,255,255,0.9); display: flex; flex-direction: column;
            align-items: center; justify-content: center; z-index: 2000; text-align: center;
        }
    </style>
</head>
<body>

<header>
    <div class="logo"><span>A</span><span>G</span><span>O</span><span>R</span><span>A</span> <span>Master</span></div>
    <div id="user-xp" style="font-weight: 500; color: var(--g-blue);">0 XP</div>
</header>

<main class="container" id="main-view">
    <h2 style="font-weight: 400; margin-bottom: 25px;">Mes Comp√©tences AGORA</h2>
    
    <div id="skills-list">
        </div>
</main>

<main class="container hidden" id="quiz-view">
    <div id="quiz-content">
        <div id="progress-text" style="font-size: 12px; color: #5f6368; margin-bottom: 10px;">Question 1/3</div>
        <h3 id="q-text" style="font-weight: 400; margin-top: 0;"></h3>
        <div id="options-container"></div>
        <div id="q-feedback" class="hidden feedback"></div>
        <button id="next-btn" class="btn hidden" onclick="handleNext()">Continuer</button>
    </div>
</main>

<script>
    const themes = [
        { id: 'A', title: 'Recrutement', icon: 'üë§', color: '#4285F4', questions: [
            { q: "Diff√©rence entre recrutement interne et externe ?", options: ["L'interne est plus cher [cite: 6]", "L'externe cible des personnes hors personnel [cite: 7]", "L'interne n'a pas d'entretien [cite: 8]"], ans: 1, expl: "Le recrutement externe s'adresse √† des personnes ne faisant pas partie du personnel de l'entreprise. [cite: 7, 9]" },
            { q: "Qu'est-ce qu'une 'Fiche de poste' ?", options: ["Le CV du candidat [cite: 11]", "Le portrait du candidat id√©al [cite: 12]", "Description des missions et place organigramme [cite: 13]"], ans: 2, expl: "Elle d√©crit les missions, les t√¢ches et la place dans l'organigramme. [cite: 13, 14]" },
            { q: "Formalit√© 8 jours avant l'embauche ?", options: ["Signature contrat [cite: 16]", "Visite m√©dicale [cite: 17]", "La DPAE [cite: 18]"], ans: 2, expl: "La D√©claration Pr√©alable √† l'Embauche (DPAE) est obligatoire. [cite: 18, 19]" }
        ]},
        { id: 'B', title: 'Int√©gration', icon: 'ü§ù', color: '#EA4335', questions: [
            { q: "Qu'est-ce que l'Onboarding ?", options: ["Un licenciement", "Un processus d'accueil des nouveaux [cite: 30]", "Une r√©union de direction"], ans: 1, expl: "C'est l'embarquement : l'accueil pour bien int√©grer les nouveaux. [cite: 29, 30]" },
            { q: "Contenu du livret d'accueil ?", options: ["Bulletins de salaire [cite: 33]", "Organigramme et r√®glement int√©rieur [cite: 34]", "Codes bancaires [cite: 35]"], ans: 1, expl: "Il contient l'organigramme, le r√®glement et les infos pratiques. [cite: 34, 36]" }
        ]},
        { id: 'C', title: 'Gestion Administrative', icon: 'üìÇ', color: '#FBBC05', questions: [
            { q: "Amende pour non-tenue du registre du personnel ?", options: ["135 ‚Ç¨ [cite: 59]", "750 ‚Ç¨ par salari√© [cite: 60]", "Fermeture d√©finitive [cite: 61]"], ans: 1, expl: "L'employeur risque 750 ‚Ç¨ d'amende par salari√© concern√©. [cite: 60, 62]" },
            { q: "Quand un avenant est-il OBLIGATOIRE ?", options: ["Changement de d√©co [cite: 66]", "Changement de banque [cite: 67]", "Modif √©l√©ment essentiel (salaire, lieu) [cite: 65]"], ans: 2, expl: "Obligatoire pour modifier la r√©mun√©ration, la dur√©e, le lieu ou le poste. [cite: 65, 67]" }
        ]},
        { id: 'D', title: 'D√©placements', icon: '‚úàÔ∏è', color: '#34A853', questions: [
            { q: "Document couvrant le salari√© en cas d'accident ?", options: ["Billet de train [cite: 74]", "Ordre de mission [cite: 75]", "Devis h√¥tel [cite: 76]"], ans: 1, expl: "L'ordre de mission est le document obligatoire pour la couverture. [cite: 75, 77]" },
            { q: "Les 3 types de contraintes ?", options: ["Temporelles, g√©ographiques, financi√®res [cite: 79]", "M√©t√©o et gastronomie [cite: 80]", "Informatique et politique [cite: 81]"], ans: 0, expl: "On prend en compte le temps, le lieu et le budget. [cite: 79, 81]" }
        ]}
    ];

    let state = JSON.parse(localStorage.getItem('agoraMasterData')) || { xp: 0, progress: { A:0, B:0, C:0, D:0 } };
    let currentT = null; let currentQIdx = 0; let canClick = true;

    function save() { localStorage.setItem('agoraMasterData', JSON.stringify(state)); }

    function renderMenu() {
        const list = document.getElementById('skills-list');
        list.innerHTML = '';
        themes.forEach(t => {
            const p = state.progress[t.id];
            list.innerHTML += `
                <div class="skill-card" onclick="startQuiz('${t.id}')">
                    <div class="skill-icon" style="background:${t.color}">${t.icon}</div>
                    <div class="skill-info">
                        <div class="skill-title">${t.title}</div>
                        <div class="skill-progress"><div class="progress-bar" style="width:${p}%; background:${t.color}"></div></div>
                    </div>
                    <div style="font-size:12px; color:#5f6368; margin-left:10px;">${p}%</div>
                </div>`;
        });
        document.getElementById('user-xp').innerText = `${state.xp} XP`;
    }

    function startQuiz(id) {
        currentT = themes.find(t => t.id === id);
        currentQIdx = 0;
        document.getElementById('main-view').classList.add('hidden');
        document.getElementById('quiz-view').classList.remove('hidden');
        showQuestion();
    }

    function showQuestion() {
        canClick = true;
        const q = currentT.questions[currentQIdx];
        document.getElementById('progress-text').innerText = `Question ${currentQIdx + 1}/${currentT.questions.length}`;
        document.getElementById('q-text').innerText = q.q;
        const container = document.getElementById('options-container');
        container.innerHTML = '';
        q.options.forEach((opt, i) => {
            const d = document.createElement('div');
            d.className = 'option'; d.innerText = opt;
            d.onclick = () => checkAns(i, d);
            container.appendChild(d);
        });
        document.getElementById('q-feedback').classList.add('hidden');
        document.getElementById('next-btn').classList.add('hidden');
    }

    function checkAns(idx, el) {
        if(!canClick) return; canClick = false;
        const q = currentT.questions[currentQIdx];
        const opts = document.querySelectorAll('.option');
        if(idx === q.ans) {
            el.classList.add('correct'); state.xp += 20;
        } else {
            el.classList.add('incorrect'); opts[q.ans].classList.add('correct');
        }
        const fb = document.getElementById('q-feedback');
        fb.innerText = q.expl; fb.classList.remove('hidden');
        document.getElementById('next-btn').classList.remove('hidden');
        save();
    }

    function handleNext() {
        currentQIdx++;
        if(currentQIdx < currentT.questions.length) showQuestion();
        else finishTheme();
    }

    function finishTheme() {
        state.progress[currentT.id] = 100; state.xp += 50; save();
        const overlay = document.createElement('div');
        overlay.className = 'success-overlay';
        overlay.innerHTML = `
            <div style="font-size:60px;">üèÜ</div>
            <h2 style="color:var(--g-blue)">Ma√Ætrise acquise !</h2>
            <p>F√©licitations, tu as termin√© le th√®me ${currentT.title}</p>
            <button class="btn" style="width:200px" onclick="location.reload()">Retour au menu</button>
        `;
        document.body.appendChild(overlay);
    }

    renderMenu();
</script>
</body>
</html>
