<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AGORA Master - Syst√®me Int√©gr√© v5.0</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&family=Orbitron:wght@700&display=swap" rel="stylesheet">
    <style>
        :root {
            --pgi-blue: #2563eb; --pgi-dark: #0f172a; --pgi-bg: #f8fafc;
            --accent: #8b5cf6; --cyan: #06b6d4; --pink: #ec4899;
            --success: #10b981; --error: #ef4444; --text: #1e293b;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Plus Jakarta Sans', sans-serif; }
        body { background: var(--pgi-bg); color: var(--text); display: flex; height: 100vh; overflow: hidden; }

        /* SIDEBAR & MOBILE BURGER */
        .sidebar { 
            width: 280px; background: var(--pgi-dark); color: white; display: flex; 
            flex-direction: column; transition: 0.3s; z-index: 1001;
        }
        .sidebar-header { padding: 25px; background: var(--pgi-blue); font-family: 'Orbitron', sans-serif; font-size: 1.1rem; display: flex; justify-content: space-between; align-items: center; }
        .nav-item { padding: 15px 25px; cursor: pointer; border-bottom: 1px solid rgba(255,255,255,0.05); transition: 0.2s; font-size: 0.9rem; display: flex; align-items: center; gap: 12px; }
        .nav-item:hover, .nav-item.active { background: rgba(255,255,255,0.1); border-left: 5px solid var(--cyan); }
        
        .burger-close { display: none; cursor: pointer; font-size: 1.5rem; }

        @media (max-width: 768px) {
            .sidebar { position: fixed; left: -280px; height: 100%; width: 280px; }
            .sidebar.open { left: 0; }
            .burger-close { display: block; }
        }

        /* MAIN CONTENT */
        .main-content { flex: 1; display: flex; flex-direction: column; overflow-y: auto; position: relative; }
        .top-bar { padding: 15px 25px; background: white; border-bottom: 1px solid #e2e8f0; display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; z-index: 100; }
        .menu-toggle { font-size: 1.5rem; cursor: pointer; display: none; color: var(--pgi-dark); }
        @media (max-width: 768px) { .menu-toggle { display: block; } }

        .xp-display { background: var(--accent); color: white; padding: 6px 15px; border-radius: 20px; font-weight: 800; font-size: 0.85rem; box-shadow: 0 0 10px rgba(139, 92, 246, 0.3); }

        .workspace { padding: 20px; max-width: 1000px; margin: 0 auto; width: 100%; }
        .widget { background: white; border-radius: 12px; padding: 25px; margin-bottom: 20px; border: 1px solid #e2e8f0; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05); }
        .widget-title { font-size: 0.9rem; font-weight: 800; color: var(--pgi-blue); text-transform: uppercase; margin-bottom: 20px; letter-spacing: 1px; border-left: 4px solid var(--pgi-blue); padding-left: 10px; }

        /* OPTIONS & LUDIQUE */
        .option { padding: 15px; border: 2px solid #f1f5f9; border-radius: 10px; margin: 10px 0; cursor: pointer; transition: 0.2s; background: #f8fafc; font-weight: 600; }
        .option:hover { border-color: var(--pgi-blue); background: #eff6ff; }
        .correct { border-color: var(--success) !important; background: #ecfdf5 !important; color: var(--success); }
        .incorrect { border-color: var(--error) !important; background: #fef2f2 !important; color: var(--error); }
        .btn-pgi { background: var(--pgi-blue); color: white; border: none; padding: 14px; border-radius: 8px; font-weight: 700; cursor: pointer; width: 100%; margin-top: 15px; }
        
        /* FLASHCARDS */
        .fc-container { perspective: 1000px; height: 260px; cursor: pointer; margin: 20px 0; }
        .fc-inner { position: relative; width: 100%; height: 100%; text-align: center; transition: transform 0.6s; transform-style: preserve-3d; }
        .fc-inner.flipped { transform: rotateY(180deg); }
        .fc-front, .fc-back { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; display: flex; align-items: center; justify-content: center; padding: 30px; border-radius: 15px; border: 2px solid var(--pgi-blue); }
        .fc-front { background: var(--pgi-blue); color: white; font-weight: 800; font-size: 1.4rem; }
        .fc-back { background: white; color: var(--text); transform: rotateY(180deg); font-size: 1.1rem; }

        .hidden { display: none; }
        #timer { font-weight: 800; color: var(--error); font-family: 'Orbitron', sans-serif; font-size: 1.6rem; text-align: center; margin-bottom: 20px; }
    </style>
</head>
<body>

    <nav class="sidebar" id="sidebar">
        <div class="sidebar-header">
            AGORA MASTER 
            <span class="burger-close" onclick="toggleMenu()">‚úï</span>
        </div>
        <div class="nav-item active" onclick="nav('dash')">üìä Dashboard</div>
        <div class="nav-item" onclick="nav('daily')">üéØ D√©fi Al√©atoire</div>
        <div class="nav-item" onclick="nav('fiches')">üìñ Fiches Ressources</div>
        <div class="nav-item" onclick="nav('flash')">üÉè Lexique / Flashcards</div>
        <div class="nav-item" onclick="nav('quiz')">‚ùì Entra√Ænement</div>
        <div class="nav-item" onclick="nav('chrono')">‚è±Ô∏è D√©fi Chrono</div>
    </nav>

    <div class="main-content">
        <header class="top-bar">
            <span class="menu-toggle" onclick="toggleMenu()">‚ò∞</span>
            <div id="breadcrumb" style="font-weight:600; opacity:0.6;">Syst√®me de Gestion RH</div>
            <div class="xp-display"><span id="xp">0</span> XP</div>
        </header>

        <div class="workspace">
            <section id="sec-dash">
                <div class="widget">
                    <h2 class="widget-title">√âtat du Syst√®me</h2>
                    <p>Interface op√©rationnelle. Pr√™t pour les r√©visions du P√¥le 3.</p>
                </div>
                <div style="display:grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap:15px;">
                    <div class="widget" style="cursor:pointer;" onclick="nav('daily')"><h3>D√©fi du jour</h3><p style="font-size:0.8rem; opacity:0.7;">Mission Manager</p></div>
                    <div class="widget" style="cursor:pointer;" onclick="nav('chrono')"><h3>Chrono Elite</h3><p style="font-size:0.8rem; opacity:0.7;">Test de vitesse</p></div>
                </div>
            </section>

            <section id="sec-daily" class="hidden">
                <div class="widget">
                    <h2 class="widget-title" id="d-title">Initialisation...</h2>
                    <p id="d-desc" style="margin-bottom:20px; font-weight:600; font-size:1.1rem;"></p>
                    <div id="d-area"></div>
                </div>
            </section>

            <section id="sec-fiches" class="hidden">
                <div id="fiches-render"></div>
            </section>

            <section id="sec-flash" class="hidden">
                <div class="widget">
                    <h2 class="widget-title">Lexique / Flashcards</h2>
                    <div class="fc-container" onclick="this.querySelector('.fc-inner').classList.toggle('flipped')">
                        <div class="fc-inner" id="fc-inner">
                            <div class="fc-front" id="fc-f">Mot</div>
                            <div class="fc-back" id="fc-b">D√©finition</div>
                        </div>
                    </div>
                    <button class="btn-pgi" onclick="loadNextFC()">Terme suivant</button>
                </div>
            </section>

            <section id="sec-quiz" class="hidden">
                <div id="q-menu" class="widget">
                    <h2 class="widget-title">S√©lecteur de Module</h2>
                    <div id="q-cats"></div>
                </div>
                <div id="q-play" class="widget hidden">
                    <h3 id="q-text" style="margin-bottom:20px;"></h3>
                    <div id="q-options"></div>
                    <div id="q-feedback" class="hidden" style="margin-top:20px; padding:15px; background:#f8fafc; border-radius:10px; border-left:4px solid var(--pgi-blue);">
                        <p id="q-expl"></p>
                        <button class="btn-pgi" onclick="proceedQuiz()">Suivant</button>
                    </div>
                </div>
            </section>

            <section id="sec-chrono" class="hidden">
                <div class="widget">
                    <h2 class="widget-title">√âpreuve de Vitesse</h2>
                    <div id="timer">02:00</div>
                    <button id="c-start" class="btn-pgi" onclick="startChronoChallenge()">D√©marrer (Max questions / 2 min)</button>
                    <div id="c-play" class="hidden">
                        <h3 id="c-q" style="margin-bottom:20px;"></h3>
                        <div id="c-opts"></div>
                    </div>
                </div>
            </section>
        </div>
    </div>

<script>
// --- DONN√âES EXHAUSTIVES ---
const db = {
    fiches: [
        { t: "Fiche 1 : Recrutement & Int√©gration", c: "<b>Pr√©paration :</b> Cr√©ation de poste ou remplacement. Outils : <b>Fiche de poste</b> (missions, t√¢ches, organigramme) et <b>Profil de poste</b> (candidat id√©al, dipl√¥mes, savoir-√™tre). <br><b>Modes :</b> Interne (valorisant, moins cher) vs Externe (id√©es neuves, vivier large). <br><b>Int√©gration :</b> DPAE obligatoire 8j avant l'embauche. Accueil : livret d'accueil, tuteur, Team Building." },
        { t: "Fiche 2 : Gestion Administrative", c: "<b>Contrat de travail :</b> Obligations r√©ciproques, immuable sans accord bilat√©ral. Mentions : identit√©, r√©mun√©ration, dur√©e, lieu, p√©riode d'essai. <br><b>Registre Unique :</b> Obligatoire d√®s le 1er salari√©, ind√©l√©bile, chronologique. Conservation : 5 ans apr√®s d√©part. <br><b>Avenant :</b> Obligatoire pour modif √©l√©ment essentiel (Salaire, Lieu, Poste, Dur√©e)." },
        { t: "Fiche 3 : Organisation D√©placements", c: "<b>Analyse :</b> Contraintes temporelles, g√©ographiques et financi√®res. <br><b>Ordre de Mission :</b> Document obligatoire pour protection accident et remboursement frais. <br><b>Sant√© :</b> Carte Europ√©enne d'Assurance Maladie (demande 15j avant pour l'UE)." },
        { t: "Fiche 4 : Calculs & Paie", c: "<b>Salaire de base :</b> Taux horaire x Nombre d'heures (souvent 151,67h). <br><b>Salaire Brut :</b> Base + Primes + Avantages en nature (v√©hicule, repas). <br><b>Avantages en nature :</b> Soumis √† cotisations sociales." }
    ],
    lexique: [
        { t: "DPAE", d: "D√©claration Pr√©alable √† l'Embauche (obligatoire 8j avant)." },
        { t: "Onboarding", d: "Processus complet d'accueil et d'int√©gration d'un nouveau salari√©." },
        { t: "Avenant", d: "Modification officielle d'un contrat de travail existant." },
        { t: "Ordre de Mission", d: "Document autorisant un d√©placement pro et assurant la protection sociale." },
        { t: "CEAM", d: "Carte Europ√©enne d'Assurance Maladie (soins en Europe)." },
        { t: "Registre Unique", d: "Document recensant chronologiquement toutes les entr√©es/sorties du personnel." },
        { t: "Fiche de Poste", d: "Description pr√©cise des missions, t√¢ches et liens hi√©rarchiques." },
        { t: "Profil de Poste", d: "Portrait robot du candidat id√©al (dipl√¥mes, comp√©tences, savoir-√™tre)." },
        { t: "CROC", d: "M√©thode d'appel : Contact, Raison, Objectif, Cong√©." },
        { t: "RGPD", d: "R√®glement G√©n√©ral sur la Protection des Donn√©es." },
        { t: "PGI", d: "Progiciel de Gestion Int√©gr√© (ERP)." },
        { t: "VIP", d: "Visite d'Information et de Pr√©vention (remplace la visite m√©dicale)." }
    ],
    quiz: {
        recrutement: [
            { q: "Quelle diff√©rence entre recrutement interne et externe ?", o: ["L'interne est plus cher", "L'externe cible le march√© du travail", "L'interne n'a pas d'entretien"], a: 1, e: "L'externe s'adresse aux personnes hors personnel." },
            { q: "Qu'est-ce qu'une fiche de poste ?", o: ["Un CV", "Une description des missions et organigramme", "Une annonce LinkedIn"], a: 1, e: "Elle d√©crit les t√¢ches et la hi√©rarchie." }
        ],
        admin: [
            { q: "Amende non-tenue registre ?", o: ["135‚Ç¨", "750‚Ç¨ par salari√©", "Fermeture"], a: 1, e: "750‚Ç¨ d'amende par salari√© concern√©." },
            { q: "Quand l'avenant est-il obligatoire ?", o: ["Changement de t√©l√©phone", "Modification salaire ou lieu", "Changement de banque"], a: 1, e: "Obligatoire pour tout √©l√©ment essentiel." }
        ]
    },
    daily: [
        { t: "Calcul Gloria", d: "Gloria (18,59‚Ç¨/h) travaille 151,67h. Calculez son salaire brut.", ans: 2819.54, type: "calc", e: "18,59 x 151,67 = 2819,54‚Ç¨." },
        { t: "Audit Registre", d: "Luis (entr√©e 10/01) est inscrit apr√®s Sophie (14/01). Pourquoi est-ce faux ?", o: ["Noms mal √©crits", "Ordre chronologique non respect√©", "L√©gal"], a: 1, e: "Le registre doit suivre l'ordre d'embauche." },
        { t: "D√©placement Espagne", d: "Un salari√© majeur a une CNI de 2010. Est-elle valide en 2024 ?", o: ["Oui", "Non"], a: 0, e: "La validit√© est de 15 ans pour les majeurs." }
    ]
};

// --- LOGIQUE SYST√àME ---
let state = { xp: 0, qSet: [], qIdx: 0, fcIdx: 0, timer: null };

function shuffle(a) { return a.sort(() => Math.random() - 0.5); }

function toggleMenu() { document.getElementById('sidebar').classList.toggle('open'); }

function nav(id) {
    document.querySelectorAll('section').forEach(s => s.classList.add('hidden'));
    document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
    document.getElementById('sec-' + id).classList.remove('hidden');
    if(id === 'flash') loadNextFC();
    if(id === 'daily') loadRandomDaily();
    if(id === 'fiches') renderFiches();
    if(id === 'quiz') renderQuizCats();
    if(window.innerWidth <= 768) toggleMenu();
}

function renderFiches() {
    document.getElementById('fiches-render').innerHTML = db.fiches.map(f => `
        <div class="widget"><h3>${f.t}</h3><p style="margin-top:10px; line-height:1.6;">${f.c}</p></div>
    `).join('');
}

function loadNextFC() {
    const item = db.lexique[state.fcIdx];
    document.getElementById('fc-f').innerText = item.t;
    document.getElementById('fc-b').innerText = item.d;
    document.getElementById('fc-inner').classList.remove('flipped');
    state.fcIdx = (state.fcIdx + 1) % db.lexique.length;
}

function renderQuizCats() {
    document.getElementById('q-cats').innerHTML = Object.keys(db.quiz).map(k => `
        <div class="option" onclick="startQuiz('${k}')">Module : ${k.toUpperCase()}</div>
    `).join('');
}

function startQuiz(cat) {
    state.qSet = shuffle([...db.quiz[cat]]);
    state.qIdx = 0;
    document.getElementById('q-menu').classList.add('hidden');
    document.getElementById('q-play').classList.remove('hidden');
    loadQuizQ();
}

function loadQuizQ() {
    const q = state.qSet[state.qIdx];
    document.getElementById('q-text').innerText = q.q;
    document.getElementById('q-feedback').classList.add('hidden');
    const box = document.getElementById('q-options'); box.innerHTML = "";
    // Shuffle options logic
    const indices = shuffle([...Array(q.o.length).keys()]);
    indices.forEach(i => {
        const d = document.createElement('div'); d.className = 'option'; d.innerText = q.o[i];
        d.onclick = () => checkQuiz(i, d); box.appendChild(d);
    });
}

function checkQuiz(idx, el) {
    const q = state.qSet[state.qIdx];
    const items = document.querySelectorAll('#q-options .option');
    items.forEach(it => it.style.pointerEvents = 'none');
    if(idx === q.a) { 
        el.classList.add('correct'); state.xp += 100;
        confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
    } else { 
        el.classList.add('incorrect'); 
        items.forEach(it => { if(it.innerText === q.o[q.a]) it.classList.add('correct'); });
    }
    document.getElementById('q-expl').innerHTML = "<b>Analyse :</b> " + q.e;
    document.getElementById('q-feedback').classList.remove('hidden');
    document.getElementById('xp').innerText = state.xp;
}

function proceedQuiz() {
    state.qIdx++;
    if(state.qIdx < state.qSet.length) loadQuizQ();
    else { document.getElementById('q-menu').classList.remove('hidden'); document.getElementById('q-play').classList.add('hidden'); }
}

function loadRandomDaily() {
    const d = shuffle([...db.daily])[0];
    document.getElementById('d-title').innerText = "D√âFI : " + d.t;
    document.getElementById('d-desc').innerText = d.d;
    const area = document.getElementById('d-area'); area.innerHTML = "";
    if(d.type === 'calc') {
        area.innerHTML = `<input type="number" id="di" step="0.01" style="width:100%; padding:15px; margin-bottom:10px;"><button class="btn-pgi" onclick="validateDaily('${d.ans}')">Valider</button>`;
    } else {
        d.o.forEach((o, i) => area.innerHTML += `<div class="option" onclick="validateDaily(${i}, ${d.a})">${o}</div>`);
    }
}

function validateDaily(val, target) {
    const win = (val == target);
    if(win) { 
        alert("EXCELLENT ! M√©daille RH d√©bloqu√©e."); state.xp += 500; 
        document.getElementById('xp').innerText = state.xp; nav('dash');
    } else alert("ERREUR ADMINISTRATIVE. Dossier rejet√©.");
}

function startChrono() {
    const all = Object.values(db.quiz).flat();
    state.qSet = shuffle(all); state.qIdx = 0;
    document.getElementById('c-start').classList.add('hidden');
    document.getElementById('c-area').classList.remove('hidden');
    let t = 120;
    state.timer = setInterval(() => {
        t--;
        let m = Math.floor(t/60), s = t%60;
        document.getElementById('timer').innerText = `${m}:${s < 10 ? '0'+s : s}`;
        if(t <= 0) { clearInterval(state.timer); alert("SESSION TERMIN√âE."); location.reload(); }
    }, 1000);
    loadCQ();
}

function loadCQ() {
    const q = state.qSet[state.qIdx];
    document.getElementById('c-q').innerText = q.q;
    const box = document.getElementById('c-opts'); box.innerHTML = "";
    q.o.forEach((o, i) => {
        const d = document.createElement('div'); d.className = 'option'; d.innerText = o;
        d.onclick = () => { if(i === q.a) state.xp += 50; state.qIdx++; loadCQ(); };
        box.appendChild(d);
    });
}
</script>
</body>
</html>
